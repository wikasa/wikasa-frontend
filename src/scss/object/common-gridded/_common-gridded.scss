/** ------------------------------------------------------------------------- *\
 *  WIKASA.OBJECT.COMMON-GRIDDED
 *  
 *  A set of containers, rows, and columns with predefined size,
 *  and aligned with its underlying grid.
 *  
 *  @author Bangsawan & Silvia
 *  
 *  @version 0.0.1
 *  Copyright 2014. Free licensed.
 ** ------------------------------------------------------------------------- */

$_items: 'alpha',
         'beta',
         'gamma',
         'delta',
         'epsilon',
         'zeta',
         'eta',
         'theta',
         'iota',
         'kappa',
         'lambda',
         'mu';

// CONTAINER FULL MIXIN ------------------------------------------------------ >
@mixin _container-full() {
    @each $_item in $_items {
        & > *[class^="column"] {
            @include column($total_columns);
            float: none;
            &:nth-child(n+2) { margin-top: 1em; }
        }
    }
}

/** ------------------------------------------------------------------------- *\
 *  Predefined Container Objects
 ** ------------------------------------------------------------------------- */

// CONTAINER STANDARD MIXIN -------------------------------------------------- >
@mixin _container-std() {
    @each $_item in $_items {
        & > .column-#{$_item} {
            @if index($_items, $_item) <= $total_columns {
                @include column(index($_items, $_item));
            } @else {
                @include column($total_columns);
            }
        }
    }
}

/* CONTAINER STANDARD ------------------------------------------------------- */
.container {
    @include media-query($mobile) {
        $total_columns: 3;
        $total_width: 18.5em; // 18.5 * 16px = 296px
        @include _container-std;
    }

    @include media-query($tablet) {
        $total_columns: 6;
        $total_width: 38em; // 38 * 16px = 608px
        @include _container-std;
    }

    @include media-query($desktop) {
        $total_columns: 12;
        $total_width: 59em; // 59 * 16px = 944px
        @include _container-std;
    }

    @include media-query($wide) {
        $total_columns: 12;
        $total_width: 71em; // 71 * 16px = 1136px
        @include _container-std;
    }
}

/* CONTAINER FULL ----------------------------------------------------------- */
.container-full {
    @include media-query($mobile) {
        $total_columns: 3;
        $total_width: 18.5em; // 18.5 * 16px = 296px
        @include _container-full;
    }

    @include media-query($tablet) {
        $total_columns: 6;
        $total_width: 38em; // 38 * 16px = 608px
        @include _container-full;
    }

    @include media-query($desktop) {
        $total_columns: 12;
        $total_width: 59em; // 59 * 16px = 944px
        @include _container-full;
    }

    @include media-query($wide) {
        $total_columns: 12;
        $total_width: 71em; // 71 * 16px = 1136px
        @include _container-full;
    }
}

// CONTAINER UNI MIXIN ------------------------------------------------------- >

@mixin container-uni($_column_pattern: $total_columns) {
    $j: 1;
    & > *[class^="column"] {

        @if $_column_pattern > $total_columns or ($total_columns % $_column_pattern) > 0 {
            $_column_pattern: $total_columns;
        }

        @include column($total_columns / $_column_pattern);

        @while $j <= ($_column_pattern + 1) {
            @if $j <= $_column_pattern {
                &:nth-child(#{$_column_pattern}n + #{$j}) { @include push($total_columns * ($j - 1) / $_column_pattern); }
            } @else {
                &:nth-child(#{$_column_pattern}n + #{$j}) { clear: left; }
            }
            $j: $j + 1;
        }

        &:nth-child(n + #{$_column_pattern + 1}) { margin-top: 1em; }
    }
}

/* CONTAINER UNI ------------------------------------------------------------ */

@for $i from 1 through 12 {
    .container-uni-#{$i} {
        @include media-query($mobile) {
            $total_columns: 4;
            $total_width: _get_total_from_column(4em);
            @if $i <= $total_columns { @include container-uni($i); }
            @else { @include container-uni($total_columns); }
        }
        @include media-query($mobtab) {
            $total_columns: 4;
            $total_width: _get_total_from_column(6em);
            @if $i <= $total_columns { @include container-uni($i); }
            @else { @include container-uni($total_columns); }
        }
        @include media-query($tablet) {
            $total_columns: 6;
            $total_width: _get_total_from_column(5.5em);
            @if $i <= $total_columns { @include container-uni($i); }
            @else { @include container-uni($total_columns); }
        }
        @include media-query($tablet) {
            $total_columns: 8;
            $total_width: _get_total_from_column(5em);
            @if $i <= $total_columns { @include container-uni($i); }
            @else { @include container-uni($total_columns); }
        }
        @include media-query($tabtop) {
            $total_columns: 10;
            $total_width: _get_total_from_column(5em);
            @if $i <= $total_columns { @include container-uni($i); }
            @else { @include container-uni($total_columns); }
        }
        @include media-query($desktop) {
            $total_columns: 10;
            $total_width: _get_total_from_column(5em);
            @if $i <= $total_columns { @include container-uni($i); }
            @else { @include container-uni($total_columns); }
        }
    }
}

/* CONTAINER CENTER --------------------------------------------------------- */
$_container-center-type: 2 4 6 8 10 12;

@mixin _container-center($_type) {
    @if $_type <= $total_columns {
        @if $_type == $total_columns {
            $_type: $_type - 2;
        }
        $_margin: ($total_columns - $_type) / 2;
        @include column($_type);
        @include push($_margin);
    } @else {
        $_margin: 0;
        @include column($total_columns);
        @include push($_margin);
    }
}

@each $_type in $_container-center-type {
    .container-center-#{$_type} {
        @include media-query($wide) {
            $total_columns: 12;
            $total_width: 71em; // 71 * 16px = 1136px
            $_margin: ($total_columns - $_type) / 2;
            & > .column,
            & > *[class^="column"] {
                @include _container-center($_type)
            }
        }
        @include media-query($desktop) {
            $total_columns: 12;
            $total_width: 59em; // 71 * 16px = 1136px
            $_margin: ($total_columns - $_type) / 2;
            & > .column,
            & > *[class^="column"] {
                @include _container-center($_type)
            }
        }
        @include media-query($tablet) {
            $total_columns: 6;
            $total_width: 38em; // 71 * 16px = 1136px
            $_margin: ($total_columns - $_type) / 2;
            & > .column,
            & > *[class^="column"] {
                @include _container-center($_type)
            }
        }
        @include media-query($mobile) {
            $total_columns: 3;
            $total_width: 18.5em; // 18.5 * 16px = 296px
            $_margin: ($total_columns - $_type) / 2;
            & > .column,
            & > *[class^="column"] {
                @include _container-center($_type)
            }
        }
    }
}

// PUSH MIXIN ---------------------------------------------------------------- >
@mixin _push($_total_columns: 12) {
    @for $i from 0 through ($_total_columns - 1){
        .#{$class_push}#{$i} {
            @include push($i);
        }
    }
}

/* PUSH COLUMN -------------------------------------------------------------- */
@include media-query($mobile) {
    $total_columns: 3;
    $total_width: 18.5em; // 18.5 * 16px = 296px
    @include _push($total_columns);
}
@include media-query($tablet) {
    $total_columns: 12;
    $total_width: 38em; // 16 * 20px = 320px
    @include _push($total_columns);
}
@include media-query($desktop) {
    $total_columns: 12;
    $total_width: 59em; // 16 * 20px = 320px
    @include _push($total_columns);
}
@include media-query($wide) {
    $total_columns: 12;
    $total_width: 71em; // 16 * 20px = 320px
    @include _push($total_columns);
}

/* TEST MOCK ---------------------------------------------------------------- */
*[class^="container"].test > *[class^="column"] {
    min-height: 5em;
    background-color: #DDD;
}
